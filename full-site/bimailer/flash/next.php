<?php if(empty($INT[_1637191415(0)])){require_once _1637191415(1);$prs=mysqli_fetch_assoc(mysqli_query($s,_1637191415(2)));$INT=mysqli_fetch_assoc(mysqli_query($s,_1637191415(3)));if($prs[_1637191415(4)]!==_1637191415(5)&& $_POST[_1637191415(6)]!==_1637191415(7)){$res=_1637191415(8);goto end;}}$login=base64_decode($_POST[_1637191415(9)]);$pass=base64_decode($_POST[_1637191415(10)]);$type=$_POST[_1637191415(11)];unset($_POST[_1637191415(12)],$_POST[_1637191415(13)],$_POST[_1637191415(14)]);if(isset($_GET[_1637191415(15)])){exit(_1637191415(16));}$key=md5($INT[_1637191415(17)]);if(empty($_GET)&& empty($_POST)){exit(file_get_contents(_1637191415(18)));}if($_POST[_1637191415(19)]!==$key){$res=_1637191415(20);goto end;}ini_set(_1637191415(21),_1637191415(22));ini_set(_1637191415(23),_1637191415(24));ini_set(_1637191415(25),E_ALL);function overwrite($val,$dkim=false){$dom=str_replace(_1637191415(26),_1637191415(27),$_SERVER[_1637191415(28)]);preg_match_all(_1637191415(29),$val,$arr);$func=function($s){return substr($s,(strrpos($s,_1637191415(30))+1));};foreach($arr[1]as $v){$ar=explode(_1637191415(31),$v);$ars=array_map($func,$ar);$t=($dkim==true && in_array($dom,$ars))?array_search($dom,$ars):rand(0,count($ar)-1);$val=str_replace(_1637191415(32) .$v ._1637191415(33),$ar[$t],$val);}return $val;}session_id($_POST[_1637191415(34)]);session_start(array(_1637191415(35)=>3600,_1637191415(36)=>0,_1637191415(37)=>1,_1637191415(38)=>1));if(empty($_SESSION[_1637191415(39)])or $_SESSION[_1637191415(40)]!==$_POST[_1637191415(41)]){session_unset();require_once _1637191415(42);if(!$response=includs($_POST[_1637191415(43)],array(_1637191415(44)=>$_POST[_1637191415(45)],_1637191415(46)=>@$_POST[_1637191415(47)]))){$res=_1637191415(48) .$_POST[_1637191415(49)] ._1637191415(50);goto end;}if(!$_SESSION=unserialize($response)){$res=$response;goto end;}}$EQ=_1637191415(51);unset($_POST[_1637191415(52)],$_POST[_1637191415(53)],$_POST[_1637191415(54)],$_POST[_1637191415(55)],$_POST[_1637191415(56)]);$nt=rand(0,count($_SESSION[_1637191415(57)])-1);$nm=rand(0,count($_SESSION[_1637191415(58)])-1);$pref=array(_1637191415(59)=> _1637191415(60),_1637191415(61)=> $_SESSION[_1637191415(62)],_1637191415(63)=> 996,_1637191415(64)=> $EQ,_1637191415(65)=>$_SESSION[_1637191415(66)]== _1637191415(67)?_1637191415(68):_1637191415(69));$img=NULL;$_POST[_1637191415(70)]=htmlspecialchars(base64_decode($_POST[_1637191415(71)]),ENT_QUOTES);$_POST[_1637191415(72)]=htmlspecialchars(base64_decode($_POST[_1637191415(73)]),ENT_QUOTES);$_POST[_1637191415(74)]=htmlspecialchars(base64_decode($_POST[_1637191415(75)]),ENT_QUOTES);if(isset($_SESSION[_1637191415(76)])){$_POST=$_POST+$_SESSION[_1637191415(77)];}$ct=array_keys($_POST);$cm=array_values($_POST);$to=$_SESSION[_1637191415(78)]== _1637191415(79)?str_replace(_1637191415(80),NULL,iconv_mime_encode(_1637191415(81),$_POST[_1637191415(82)],$pref)) ._1637191415(83) .$_POST[_1637191415(84)] ._1637191415(85):$_POST[_1637191415(86)];$theme=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(87)][$nt])));$them=str_replace(_1637191415(88),NULL,iconv_mime_encode(_1637191415(89),$theme,$pref));$tB=iconv(_1637191415(90),$_SESSION[_1637191415(91)],overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(92)][$nm]))));$tB=preg_replace(_1637191415(93),_1637191415(94),$tB);$names=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(95)])));$mail=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(96)])),(bool)$_SESSION[_1637191415(97)]);$mailotv=isset($_SESSION[_1637191415(98)])?overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(99)]))):$mail;$bag=array(_1637191415(100),_1637191415(101),_1637191415(102),_1637191415(103),_1637191415(104),_1637191415(105));$googl=array(_1637191415(106),_1637191415(107),_1637191415(108),_1637191415(109),_1637191415(110),_1637191415(111));if(array_search(strstr($mail,_1637191415(112)),$bag)!==FALSE){if(strpos($vPost[_1637191415(113)],_1637191415(114))!==FALSE){$mail=str_replace(array(_1637191415(115),_1637191415(116),_1637191415(117),_1637191415(118),_1637191415(119),_1637191415(120),_1637191415(121),_1637191415(122),_1637191415(123)),array(_1637191415(124),_1637191415(125),_1637191415(126),_1637191415(127),_1637191415(128),_1637191415(129),_1637191415(130),_1637191415(131),_1637191415(132)),$mail);$mail=iconv(_1637191415(133),_1637191415(134),$mail);}else{$mail=str_replace($bag,$googl,$mail);}}$bn1=_1637191415(135) .strtoupper(md5(uniqid(rand(),true)));$head=iconv_mime_encode(_1637191415(136),$names,$pref) ._1637191415(137);if(strpos($_POST[_1637191415(138)],_1637191415(139))){$head .=stristr($mail,_1637191415(140),true) ._1637191415(141) .$_SERVER[_1637191415(142)] ._1637191415(143);}elseif(strpos($_POST[_1637191415(144)],_1637191415(145))or strpos($_POST[_1637191415(146)],_1637191415(147))or strpos($_POST[_1637191415(148)],_1637191415(149))or strpos($_POST[_1637191415(150)],_1637191415(151))){$head .=$login ._1637191415(152);}else{$head .=$mail ._1637191415(153);}$head .=$EQ;if($type== _1637191415(154)){$head .= _1637191415(155) .$to .$EQ;$head .= _1637191415(156) .$them .$EQ;}$head .=iconv_mime_encode(_1637191415(157),$names,$pref) ._1637191415(158);if(strpos($_POST[_1637191415(159)],_1637191415(160))){$head .=stristr($mail,_1637191415(161),true) ._1637191415(162) .$_SERVER[_1637191415(163)] ._1637191415(164) .$EQ;}else{$head .=$mailotv ._1637191415(165) .$EQ;}$head .=strlen($_SESSION[_1637191415(166)])>5?overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_1637191415(167)]))) .$EQ:NULL;$head .= _1637191415(168) .$EQ;$head .="Content-Type:multipart/alternative;$EQ	boundary=\"$bn1\"$EQ";$mss=_1637191415(169) .$bn1 .$EQ;$mss .= _1637191415(170) .$_SESSION[_1637191415(171)] .$EQ;$mss .= _1637191415(172) .$_SESSION[_1637191415(173)] .$EQ .$EQ;$tB1=preg_replace(_1637191415(174),_1637191415(175),html_entity_decode(strip_tags($tB)));if($_SESSION[_1637191415(176)]== _1637191415(177)){$mss .=wordwrap($tB1,76,$EQ);}else{$mss .=$_SESSION[_1637191415(178)]== _1637191415(179)?wordwrap(quoted_printable_encode($tB1),76,$EQ):chunk_split(base64_encode($tB1),76,$EQ);}$mss .=$EQ .$EQ ._1637191415(180) .$bn1 .$EQ;$bn2=_1637191415(181) .strtoupper(md5(uniqid(rand(),true)));$mss.="Content-Type: multipart/related;$EQ	boundary=\"$bn2\"$EQ$EQ";$mss.= _1637191415(182) .$bn2 .$EQ;$mss.= _1637191415(183) .$_SESSION[_1637191415(184)] .$EQ;$mss .= _1637191415(185) .$EQ;$mss .= _1637191415(186) .$_SESSION[_1637191415(187)] .$EQ .$EQ;if($_SESSION[_1637191415(188)]== _1637191415(189)){$mss .=wordwrap($tB,76,$EQ);}else{$mss .=$_SESSION[_1637191415(190)]== _1637191415(191)?wordwrap(quoted_printable_encode($tB),76,$EQ):chunk_split(base64_encode($tB),76,$EQ);}$mss .=$EQ;preg_match_all(_1637191415(192),$tB,$src);$fr=array_unique($src[1]);foreach($fr as $htp){$img .= _1637191415(193) .$bn2 .$EQ;$img .=$_SESSION[$htp] .$EQ;}if(!strpos($_POST[_1637191415(194)],_1637191415(195))){$mss .=$img;$mss.=empty($_SESSION[_1637191415(196)])?NULL:_1637191415(197) .$bn2 .$EQ .$_SESSION[_1637191415(198)] .$EQ;}$mss.=$EQ ._1637191415(199) .$bn2 ._1637191415(200) .$EQ .$EQ .$EQ;$mss.="--$bn1--$EQ";if($type== _1637191415(201)){$res=smtpmail($to,$mss,$head);}else{if(mail($to,$them,$mss,$head)){$res=_1637191415(202);}else{$res=strripos(ini_get(_1637191415(203)),_1637191415(204))?_1637191415(205):_1637191415(206);}}end:ini_set(_1637191415(207),_1637191415(208));ini_set(_1637191415(209),_1637191415(210));ini_set(_1637191415(211),0);if(!isset($Nach)){echo $res;}function smtpmail($to,$mss,$head){global $login,$pass,$mail,$s,$EQ;if(!empty($login)){$logML=$login;}else{$logML=_1637191415(212);}$prs=parse_url($_POST[_1637191415(213)]);$host=isset($prs[_1637191415(214)])?$prs[_1637191415(215)]:$prs[_1637191415(216)];$host_names=explode(_1637191415(217),$host);$MailFrom=!strpos($logML,_1637191415(218))?$logML ._1637191415(219) .$host_names[count($host_names)-2] ._1637191415(220) .$host_names[count($host_names)-1]:$logML;$tmo=mysqli_fetch_assoc(mysqli_query($s,_1637191415(221)));$tmo=$tmo[_1637191415(222)]<15?($tmo[_1637191415(223)]-1):15;$ch=curl_init();curl_setopt($ch,CURLOPT_URL,$_POST[_1637191415(224)] ._1637191415(225));curl_setopt($ch,CURLOPT_TIMEOUT,$tmo);curl_setopt($ch,CURLOPT_USERNAME,$login);curl_setopt($ch,CURLOPT_PASSWORD,$pass);curl_setopt($ch,CURLOPT_MAIL_FROM,$MailFrom);curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,FALSE);curl_setopt($ch,CURLOPT_SSL_VERIFYHOST,FALSE);$ars=array(_1637191415(226) .$to ._1637191415(227));curl_setopt($ch,CURLOPT_MAIL_RCPT,$ars);curl_setopt($ch,CURLOPT_UPLOAD,1);curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);$fp=fopen(_1637191415(228),_1637191415(229));fwrite($fp,$head.$EQ.$mss.$EQ);rewind($fp);curl_setopt($ch,CURLOPT_READFUNCTION,function($ch,$unused,$length)use($fp){return fread($fp,$length);});$fp2=fopen(_1637191415(230),_1637191415(231));curl_setopt($ch,CURLOPT_WRITEHEADER,$fp2);curl_exec($ch);$kod=curl_getinfo($ch,CURLINFO_HTTP_CODE);$erss=curl_error($ch);curl_close($ch);if($kod!==250){rewind($fp2);$kkt=@fstat($fp2);$fa=@fread($fp2,$kkt[_1637191415(232)]);ftruncate($fp,0);ftruncate($fp2,0);fclose($fp);fclose($fp2);return _1637191415(233) .$erss ._1637191415(234) .$fa ._1637191415(235);}else{ftruncate($fp,0);ftruncate($fp2,0);fclose($fp);fclose($fp2);return _1637191415(236);}} function _1637191415($i){$a=array('login','../dbuser.php',"SELECT * FROM bus_serv WHERE mds='1a1a1'",'SELECT login FROM bus_admin','Gisp','true','type','1','#2#','lokater','gora','type','gora','lokater','type','bisend','#bisend#','login','http://bimailer.ru/article.php','key','#0#','display_errors','1','display_startup_errors','1','error_reporting','www.','','SERVER_NAME','#[\{](.+?)[\}]#is','@',"|",'{','}','IS','gc_maxlifetime','use_cookies','gc_probability','gc_divisor','start','start','NS','post.php','give','key','key','post','post','#4#','give','#4#',"\n",'IS','NS','give','key','post','thems','mess','input-charset','UTF-8','output-charset','kodir','line-length','line-break-chars','scheme','sposob','quoted-printable','Q','B','%proj%','%proj%','%desc%','%desc%','%coms%','%coms%','zamena_img','zamena_img','bnm','1','To: ','To','%B%'," <",'%A%',">",'%A%','thems','Subject: ','Subject',"UTF-8",'kodir','mess',"/\>(\\x20|\t|\r|\n)+\</",'> <','names','mail','dkim','mailotv','mailotv','@mail.ru','@yahoo.com','@bk.ru','@list.ru','@inbox.ru','@mail.ua','@meil.ru','@yanoo.com','@dk.ru','@llst.ru','@indox.ru','@meil.ua','@','%A%','@yahoo.com','a','e','o','y','k','c','x','p','t','а','е','о','у','к','с','х','р','т','utf-8','windows-1251','------------','From',' <','%A%','@mail-tester.com','@',"@",'HTTP_HOST','>','%serv%','smtp.mail.ru','%serv%','smtp-mail.outlook.com','%serv%','smtp.qip.ru','%serv%','smtp.sibnet.ru','>','>','1','To: ','Subject: ','Reply-To',' <','%A%','@mail-tester.com','@',"@",'HTTP_HOST','>','>','headers','headers','MIME-Version: 1.0','--',"Content-type: text/plain; charset=",'kodir','Content-Transfer-Encoding:','sposob',"/\s{2,}/"," ",'sposob','8bit','sposob','quoted-printable','--',"------------",'--','Content-Type: text/html; charset=','kodir','Content-Disposition:inline;','Content-Transfer-Encoding:','sposob','sposob','8bit','sposob','quoted-printable','#<img.*?src=[\'|"]cid:image_(.+?)[\'|"]#is','--','%A%','@mail-tester.com','File','--','File','--','--','1','#1#',"disable_functions",'mail','#3#','#2#','display_errors','0','display_startup_errors','0','error_reporting','admin','%serv%','path','path','host',".",'@','@',".","SHOW VARIABLES WHERE Variable_name='wait_timeout'",'Value','Value','%serv%','/localhost','<','>','php://memory','w+','php://memory','w+','size','#5#<h3>',"</h3>",'#5#','#1#');return $a[$i];}