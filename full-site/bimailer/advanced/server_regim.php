<?php require_once _1369686710(0);is_array($INT)or empty($regim)?:exit(header(_1369686710(1),TRUE,301));$regim=strip_tags(htmlspecialchars($_POST[_1369686710(2)]));switch($regim){case _1369686710(3):$type=_1369686710(4);$url=filter_var(trim($_POST[_1369686710(5)]),FILTER_SANITIZE_URL);$par=parse_url($url);$url=isset($par[_1369686710(6)])?$url:_1369686710(7) .$url;if(stripos($url,_1369686710(8))!==FALSE or strpos($url,_1369686710(9))!==FALSE or stripos($url,_1369686710(10))!==FALSE or stripos($url,_1369686710(11))!==FALSE)exit(_1369686710(12));$tmo=mysqli_fetch_assoc(mysqli_query($s,_1369686710(13)));$tmo=$tmo[_1369686710(14)]<15?($tmo[_1369686710(15)]-1):15;$tst=curl_init();curl_setopt($tst,CURLOPT_URL,$url ._1369686710(16));curl_setopt($tst,CURLOPT_TIMEOUT,$tmo);curl_setopt($tst,CURLOPT_SSL_VERIFYPEER,FALSE);curl_setopt($tst,CURLOPT_SSL_VERIFYHOST,FALSE);curl_setopt($tst,CURLOPT_MAXREDIRS,15);curl_setopt($tst,CURLOPT_RETURNTRANSFER,1);curl_setopt($tst, CURLOPT_FOLLOWLOCATION, 1);$kkd=curl_getinfo($tst,CURLINFO_HTTP_CODE);if(!$otv=curl_exec($tst)){if(ini_get(_1369686710(17))!== _1369686710(18)){exit(_1369686710(19));}else{exit(_1369686710(20) .$url ._1369686710(21) .$url ._1369686710(22) .$kkd);}}if(strpos($otv,_1369686710(23))===FALSE){if($headers=@get_headers($url)){preg_match(_1369686710(24),$headers[0],$matches);if($kkd!== _1369686710(25)){exit(_1369686710(26) .$url ._1369686710(27) .$url ._1369686710(28) .$matches[0] ._1369686710(29));}}else{$error=_1369686710(30);}exit(_1369686710(31) .htmlspecialchars($otv));}curl_close($tst);$df=array(_1369686710(32)=> $url,_1369686710(33)=> _1369686710(34),_1369686710(35)=>$INT[_1369686710(36)]);require_once _1369686710(37);$ip=@gethostbyname($par[_1369686710(38)]);$newtab=mysqli_prepare($s,_1369686710(39));$md=md5($url .microtime());mysqli_stmt_bind_param($newtab,_1369686710(40),$type,$md,$url,$ip,$_POST[_1369686710(41)]);mysqli_stmt_execute($newtab);mysqli_stmt_close($newtab);echo _1369686710(42) .$md ._1369686710(43) .$url ._1369686710(44) .$ip;includs(_1369686710(45),$df,1);exit;case _1369686710(46):$ssl=filter_var($_POST[_1369686710(47)],FILTER_SANITIZE_NUMBER_INT);$smtp=($ssl==1?_1369686710(48):_1369686710(49)) .trim($_POST[_1369686710(50)]) ._1369686710(51) .filter_var($_POST[_1369686710(52)],FILTER_SANITIZE_NUMBER_INT);$losmtp=$_POST[_1369686710(53)];$pasmtp=$_POST[_1369686710(54)];if(empty($_POST[_1369686710(55)])or empty($_POST[_1369686710(56)])){$losmtp=NULL;$pasmtp=NULL;}if(stripos($smtp,_1369686710(57))!==FALSE or strpos($smtp,_1369686710(58))!==FALSE or stripos($smtp,_1369686710(59))!==FALSE or stripos($smtp,_1369686710(60))!==FALSE)exit(_1369686710(61));$kyt=_1369686710(62) .$INT[_1369686710(63)];$df=array(_1369686710(64)=> $smtp,_1369686710(65)=>$losmtp,_1369686710(66)=>$pasmtp,_1369686710(67)=>$INT[_1369686710(68)],_1369686710(69)=> _1369686710(70));$tmo=mysqli_fetch_assoc(mysqli_query($s,_1369686710(71)));$tmo=$tmo[_1369686710(72)]<15?($tmo[_1369686710(73)]-1):15;$ch=curl_init();curl_setopt($ch,CURLOPT_URL,$smtp ._1369686710(74));curl_setopt($ch,CURLOPT_TIMEOUT,$tmo);curl_setopt($ch,CURLOPT_USERNAME,$losmtp);curl_setopt($ch,CURLOPT_PASSWORD,$pasmtp);curl_setopt($ch,CURLOPT_USE_SSL,CURLUSESSL_TRY);curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,FALSE);curl_setopt($ch,CURLOPT_SSL_VERIFYHOST,FALSE);curl_setopt($ch,CURLOPT_UPLOAD,1);curl_setopt($ch,CURLOPT_CONNECT_ONLY,1);$headr=fopen(_1369686710(75),_1369686710(76));curl_setopt($ch,CURLOPT_WRITEHEADER,$headr);curl_exec($ch) ._1369686710(77);$rrf=@curl_getinfo($ch,CURLINFO_HTTP_CODE);$rrf ._1369686710(78);if($rrf!==235){rewind($headr);$rdl=@fstat($headr);exit(curl_error($ch) ._1369686710(79) .@fread($headr,$rdl[_1369686710(80)]));}curl_close($ch);require_once _1369686710(81);$md=md5($smtp .microtime());$newtab=mysqli_prepare($s,_1369686710(82));$tyk=parse_url($smtp);$ip=@gethostbyname($tyk[_1369686710(83)]);$type=_1369686710(84);mysqli_stmt_bind_param($newtab,_1369686710(85),$type,$smtp,$md,$ip,$losmtp,$pasmtp,$kyt);mysqli_stmt_execute($newtab);echo _1369686710(86) .$md ._1369686710(87) .$smtp ._1369686710(88) .$ip;includs(_1369686710(89),$df,1);exit;case _1369686710(90):$que=_1369686710(91) .implode($_POST[_1369686710(92)],_1369686710(93)) ._1369686710(94);mysqli_query($s,_1369686710(95) .$que ._1369686710(96));break;case _1369686710(97):$mds=$_POST[_1369686710(98)];$res=mysqli_fetch_assoc(mysqli_query($s,"SELECT * FROM bus_serv WHERE mds='$mds'"));echo isset($res[_1369686710(99)])?base64_decode($res[_1369686710(100)]):_1369686710(101);exit;case _1369686710(102):$pole=$_POST[_1369686710(103)]== _1369686710(104)?_1369686710(105):_1369686710(106);if($pole== _1369686710(107)){$ad=_1369686710(108);}$ne=mysqli_prepare($s,"UPDATE bus_serv SET $pole=?" .$ad ._1369686710(109));mysqli_stmt_bind_param($ne,_1369686710(110),$_POST[_1369686710(111)],$_POST[_1369686710(112)]);mysqli_stmt_execute($ne);mysqli_stmt_close($ne);exit;break;case _1369686710(113):$val=$_POST[_1369686710(114)]== _1369686710(115)?_1369686710(116):_1369686710(117);mysqli_query($s,"UPDATE bus_serv SET Gisp='$val'");exit;break;case _1369686710(118):$val=$_POST[_1369686710(119)];$mds=$_POST[_1369686710(120)];$ne=mysqli_prepare($s,_1369686710(121));mysqli_stmt_bind_param($ne,_1369686710(122),$_POST[_1369686710(123)],$_POST[_1369686710(124)]);mysqli_stmt_execute($ne);exit;break;} function _1369686710($i){$a=array("../dbuser.php",'Location: /bimailer/bases.php','regi',"adurl",'0','url','scheme','http://','localhost','127.0.0.1','busmail.ru','bimailer.ru','2|запрещено',"SHOW VARIABLES WHERE Variable_name='wait_timeout'",'Value','Value','?bisend=1','allow_url_fopen','1','3|Необходимо разрешить PHP работать с удаленными файлами изменив настройку php.ini на <em>allow_url_fopen = On;</em>.<br>','3|Сервер недоступен или неотвечает. Проверьте ссылку  <a target="_blank" href="','?bisend=1">','</a> через браузер.<br> Код:','#bisend#','/\d{3}/','200','3|Проверьте доступность <a target="_blank"  href="','">','</a> через браузер. Его код ответа равен <a target="_blank"  href="https://www.bertal.ru/help.php?ex=1">','</a>, что неверно.','Сервер не вернул заголовки.','3|Указаный URL не является файлом для рассылки: ','uri','type','0','logim','login',"../flash/post.php",'host','INSERT INTO bus_serv SET type=?, mds=?, url=?, ip=?, com=?','issss','com','1|','|','|','server_regim.php',"adsmtp",'ssl','smtps://','smtp://','smtp',':','port','login','pasw','login','pasw','localhost','127.0.0.1','busmail.ru','bimailer.ru','2|запрещено','serversmtp','login','smtp','login','pasw','logim','login','type','1',"SHOW VARIABLES WHERE Variable_name='wait_timeout'",'Value','Value','/localhost','php://memory','w+','<br>','<br>','|','size',"../flash/post.php",'INSERT INTO bus_serv SET type=?, url=?, mds=?, ip=?, login=?, pass=AES_ENCRYPT(?,?)','host','1','issssss','1|','|','|','server_regim.php',"dell","'",'serv',"','","'",'DELETE FROM bus_serv WHERE mds IN (',')',"readerr",'mds','ers','ers','отсутсвуют',"red",'pole','3','com','lim','lim',", progr='0'"," WHERE mds=?",'ss','val','mds',"globalispolz",'val','true','true','false',"check",'val','mds',"UPDATE bus_serv SET Gisp=? WHERE mds=?",'ss','val','mds');return $a[$i];}