<?php $version=_290734774(0);if(isset($_POST[_290734774(1)])){foreach($_COOKIE as $key => $val){setcookie($key,$val,time()-86400,_290734774(2));}exit;}if(isset($_POST[_290734774(3)])){setcookie($_POST[_290734774(4)],$_POST[_290734774(5)],time()+86400,_290734774(6));exit(header(_290734774(7),TRUE,301));}if(isset($_POST[_290734774(8)])&& isset($_POST[_290734774(9)])&& isset($_POST[_290734774(10)])){require_once _290734774(11);require_once _290734774(12);$df=array(_290734774(13)=> base64_encode($_POST[_290734774(14)]),_290734774(15)=>base64_encode($_POST[_290734774(16)]),_290734774(17)=> $_POST[_290734774(18)]);$it=mysqli_query($s,_290734774(19));if(mysqli_num_rows($it)>0){$dano=mysqli_fetch_assoc($it);strlen($_POST[_290734774(20)])>1 || strlen($_POST[_290734774(21)])>1?:exit(_290734774(22));$dano[_290734774(23)]==$_POST[_290734774(24)]?:exit(_290734774(25));$nummess=mysqli_fetch_assoc(mysqli_query($s,_290734774(26)));$df[_290734774(27)]=$nummess[_290734774(28)];$res=includs(_290734774(29),$df,1);$res=stristr($res,_290734774(30))?unserialize($res):exit($res);if((float)$version>(float)$dano[_290734774(31)]){require_once _290734774(32);}if((float)$res[_290734774(33)]>(float)$version){$updthem=base64_encode(_290734774(34));$updtmess=base64_encode(_290734774(35));mysqli_query($s,"REPLACE INTO bus_mess SET them='$updthem', mess='$updtmess', hash='3908djfigb39rgb9234'");}$go=unserialize(base64_decode($res[_290734774(36)]));$mesad=mysqli_prepare($s,_290734774(37));mysqli_stmt_bind_param($mesad,_290734774(38),$t,$m,$d,$h);$i=0;while($i<count($go)){$t=$go[$i][_290734774(39)];$m=$go[$i][_290734774(40)];$d=$go[$i][_290734774(41)];$h=md5($t);mysqli_stmt_execute($mesad);$i++;}mysqli_query($s,_290734774(42) .$res[_290734774(43)]);mysqli_query($s,_290734774(44) .$res[_290734774(45)] ._290734774(46) .$res[_290734774(47)] ._290734774(48) .$res[_290734774(49)] ._290734774(50) .$res[_290734774(51)] ._290734774(52));$dw=setcookie($res[_290734774(53)],$res[_290734774(54)],time()+86400,_290734774(55))?_290734774(56):_290734774(57);exit($dw);}else{$res=includs(_290734774(58),$df,1);function SSL(){if(isset($_SERVER[_290734774(59)])&& $_SERVER[_290734774(60)]== _290734774(61)){return _290734774(62);}elseif(!empty($_SERVER[_290734774(63)])&& $_SERVER[_290734774(64)]== _290734774(65)||!empty($_SERVER[_290734774(66)])&& $_SERVER[_290734774(67)]== _290734774(68)){return _290734774(69);}return _290734774(70);}$ser=SSL() ._290734774(71) .$_SERVER[_290734774(72)] ._290734774(73);$res=stristr($res,_290734774(74))?unserialize($res):exit($res);(float)$res[_290734774(75)]>(float)$version?exit(_290734774(76)):NULL;$stmt=mysqli_prepare($s,_290734774(77));mysqli_stmt_bind_param($stmt,_290734774(78),base64_decode($res[_290734774(79)]),$version);mysqli_stmt_execute($stmt);$stmt1=mysqli_prepare($s,_290734774(80));mysqli_stmt_bind_param($stmt1,_290734774(81),$ser,$res[_290734774(82)]);mysqli_stmt_execute($stmt1);exit(_290734774(83));}}$INT!== _290734774(84)?exit:NULL;if(!function_exists('curl_init')&& (bool)ini_get(_290734774(85))==false){$ttx=substr_count($_SERVER[_290734774(86)],_290734774(87))>0?_290734774(88):_290734774(89);exit(_290734774(90) .$ttx .$end);}$fg=file_get_contents(_290734774(91),FILE_USE_INCLUDE_PATH)or die(_290734774(92) .$end);$BOM=strpos($fg,_290734774(93));$BOM===false?:exit(_290734774(94) .$end);if(mysqli_connect_errno()){echo _290734774(95) .$end;exit;}$res=_290734774(96) .$dbuser ._290734774(97) .$dbname ._290734774(98) .$dbuser ._290734774(99) .$end;mysqli_query($s,_290734774(100))or die($res);mysqli_query($s,_290734774(101))or die($res);mysqli_query($s,_290734774(102))or die($res);mysqli_query($s,_290734774(103))or die($res);mysqli_query($s,_290734774(104))or die($res);mysqli_query($s,_290734774(105))or die($res);mysqli_query($s,_290734774(106))or die($res);mysqli_query($s,_290734774(107))or die($res);$chs=mysqli_num_rows(mysqli_query($s,_290734774(108)));if($chs<1){mysqli_query($s,_290734774(109));mysqli_query($s,_290734774(110));mysqli_query($s,_290734774(111));mysqli_query($s,_290734774(112));mysqli_query($s,_290734774(113));mysqli_query($s,_290734774(114));require_once _290734774(115);} function _290734774($i){$a=array('3.4','stat','/','autorised','Cn','Cv','/','Location: /bimailer/index.php','dmd','lgl','pwp','../dbuser.php','../flash/post.php','bnthe2egfgnutk','lgl','eafg234tr5yrgh','pwp','ojkn45qonsdgo','dmd','SELECT * FROM bus_admin','lgl','pwp','Поля не заполнены.','login','lgl','Сочетание логин-пароль введено неверно.',"SELECT val FROM bus_conf WHERE nam='idmess'",'idmess','val','inscript.php','{','vers','updater.php','version','Новая версия скрипта BiMailer','<img src="http://bimailer.ru/images/email_rassilka.png" style="float:left" /><img src="/bimailer/images/dell.png" class="dellmess" /><p>На сайте BiMailer.ru вышла новая версия скрипта. Вы можете прямо сейчас посетить сайт и скачать новую версию скрипта рассылки писем BiMailer</p><p>Для обновления, как правило достаточно заменить файлы скрипта на хостинге файлами из архива, после чего выполнить повторный вход в скрипт. Все изменения будут внесены автоматически при авторизации.</p><p>Возможные дополнительные действия для переезда на новую версию скрипта описаны на странице &quot;Обновление&quot;.</p><br><center><a href="http://bimailer.ru/help/update.php" class="but butG" title="Скрипт рассылки BiMailer" target="_blank">Скачать обновления</a></center>','mess','REPLACE INTO bus_mess SET them=?, mess=?, date=?, hash=?','ssss','th','ms','dt','REPLACE INTO bus_conf SET nam="idmess", val=','messid',"UPDATE bus_admin SET cooc='",'cName',"', nam='",'names',"', date='",'vhod',"', act='",'act',"'",'cName','cVal','/','true','Coocies не записаны, возможно dbuser.php сохранен с BOM','install.php','HTTPS','HTTPS','on','https','HTTP_X_FORWARDED_PROTO','HTTP_X_FORWARDED_PROTO','https','HTTP_X_FORWARDED_SSL','HTTP_X_FORWARDED_SSL','on','https','http','://','SERVER_NAME','/bimailer/flash/next.php','{','version','Версия скрипта устарела, скачайте новую','INSERT INTO bus_admin SET login=?, vers=?','ss','login',"INSERT INTO bus_serv SET url=?, ip=?, mds='1a1a1', com='данный хостинг'",'ss','hostip','install','install',"allow_url_fopen",'SERVER_SOFTWARE','Apache'," либо в файле скрипта /bimailer/.HTACCESS добавьте строку: <br><em>php_value allow_url_fopen on</em></td></tr>",'</td></tr>',"<tr><td style='text-align:justify; padding:10px;'><span style='color:#cc0000;'><strong>Функция PHP fopen отключена!</strong></span><br />Скрипт не может связываться с удаленными файлами.<br>
Включите диррективу <em><strong>allow_url_fopen</strong></em> в конфиге php.ini",'./dbuser.php',"<tr><td style='text-align:justify; padding:10px;'><span style='color:#cc0000;'><strong>dbuser.php не открывается</strong></span><br />Функция file_get_contents() вернула ошибку, что говорит об отсутсвии файла dbuser.php либо о запрете на его открытие.</td></tr>","\xBB\xBF","<tr><td style='text-align:justify; padding:10px;'><span style='color:#cc0000;'><strong>Перезапишите файл dbuser.php.</strong></span><br />Файл <strong>dbuser.php</strong> сохранен в кодировке <strong>&quot;UTF-8 с BOM&quot;</strong> из-за чего корректная работа скрипта невозможна:<br>1) Пересохраните <strong>&quot;dbuser.php&quot;</strong> в кодировке <u><strong>UTF-8 без BOM</strong></u><br>2) Перезалейте его на хостинг.<br><center><a title=\"Сохранение без BOM\" href=\"http://bimailer.ru/help/seves-utf8-without-dom.php\">Подробнее>></a></center></td></tr>","<tr><td style='text-align:justify; padding:10px;'><span style='color:#cc0000;'><strong>Соединение с базой MySQL не установлено.</strong></span><br />Для установки соединения необходимо:<br />1. Любым текстовым редактором откройте файл скрипта <u><strong>\"/bimailer/dbuser.php\"</strong></u>;<br />2. Укажите логин, пароль и имя базы MySQL в соответствующих полях<br>3. Сохраните файл (в UTF-8).<br>4. Замените файл <u><strong>dbuser.php</strong></u> на хостинге, новым.<br>После чего обновите данную страницу.<br>
<center><a title=\"Справка по установке\" href=\"http://bimailer.ru/help/install.php\">Подробнее>></a></center></td></tr>","<tr><td style='text-align:justify; padding:10px;'><span style='color:#cc0000;'><strong>Таблицы не могут быть созданы.</strong></span><br>Возможно созданный пользователь базы данных <strong>","</strong>, не имеет разрешений на создание таблиц в базе <strong>","</strong>.<br>Для решения проблемы, в настройках хостинга, разрешите созданному пользователю MySQL - <strong>",",</strong> вносить изменения в базу. После чего обновите станицу.<br>
<center>Подробнее можно узнать в <a href=\"http://bimailer.ru/help/install.php\">справке</a></center></td></tr>","CREATE TABLE IF NOT EXISTS bus_serv (type INTEGER(11) NOT NULL DEFAULT 0, url TEXT, login TEXT, pass BLOB, ip TEXT, com TEXT, lim INTEGER(11) NOT NULL DEFAULT 0, progr INTEGER(11) NOT NULL DEFAULT 0, date INTEGER(11) NOT NULL DEFAULT 0, Gisp enum('true', 'false') NOT NULL default 'true', isp enum('true', 'false') NOT NULL default 'true', mds CHAR(32), ers TEXT) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_proj (proj VARCHAR(225) COLLATE utf8_general_ci NOT NULL DEFAULT '0J/RgNC+0LXQutGCIDE=', names TEXT, mail TEXT, mailotv TEXT, kodir TEXT, thems TEXT, mess LONGTEXT, files TEXT, sposob enum('base64', 'quoted-printable', '8bit') NOT NULL default 'base64', headers TEXT, dkim enum('0', '1') NOT NULL default '0', date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, UNIQUE KEY proj (proj) USING BTREE) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_baser (isp enum('true', 'false') NOT NULL default 'false', spis TEXT, psev TEXT, opis TEXT, orders TEXT, vivod TEXT, data timestamp NOT NULL default CURRENT_TIMESTAMP, Bname enum('0', '1') NOT NULL default '0', adform enum('false', 'true') NOT NULL default 'false') ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_mess (them TEXT, mess LONGTEXT, smotr enum('0', '1') NOT NULL default '0', hash VARCHAR(225) COLLATE utf8_general_ci NOT NULL DEFAULT '3456456436', date timestamp NOT NULL default CURRENT_TIMESTAMP, UNIQUE KEY hash (hash) USING BTREE) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_conf (nam VARCHAR(225) COLLATE utf8_general_ci NOT NULL DEFAULT 'idmess', val TEXT, UNIQUE KEY nam (nam) USING BTREE) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_proc (proj TEXT, baza TEXT, sost enum('true', 'false'), zad int(11) NOT NULL default '0', ot int(11) NOT NULL default '0', do int(11) NOT NULL default '0', vkl int(11) NOT NULL default '5', res TEXT) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_form (id INT (11) NOT NULL auto_increment, PRIMARY KEY(id), visible enum('true', 'false') NOT NULL default 'true' COMMENT 'Отображение', names TEXT COMMENT 'Название поля', cont enum('true', 'false') NOT NULL default 'true' COMMENT 'Запрещает удаление поля', widt INT(11) COMMENT 'Ширина поля' NOT NULL default '160')  ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;","CREATE TABLE IF NOT EXISTS bus_admin (login TEXT, cooc TEXT, nam TEXT, vers TEXT, act INT (1) NOT NULL default '0', date timestamp NOT NULL default CURRENT_TIMESTAMP) ENGINE = MYISAM CHARACTER SET utf8 COLLATE utf8_general_ci;",'SELECT * FROM bus_form',"INSERT INTO bus_form SET id='1', cont='false', names='Категория', widt='160'","INSERT INTO bus_form SET id='2', cont='false', names='Ваш Email', widt='160'","INSERT INTO bus_form SET id='3', cont='false', names='Подписаться', widt='160'","INSERT INTO bus_conf SET nam='idmess', val='0'",'INSERT INTO bus_conf SET nam="hints", val="1"',"INSERT INTO bus_proc SET sost='false'",'control.php');return $a[$i];}